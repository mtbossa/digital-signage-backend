"use strict";(self.webpackChunkparoquia_pio_x_frontend=self.webpackChunkparoquia_pio_x_frontend||[]).push([[362],{8709:(R,M,r)=>{r.d(M,{S:()=>u});var C=r(655),s=r(6895),v=r(3442),g=r(7489),T=r(1135),m=r(5698),h=r(2340),E=r(4650),O=r(529);class u{constructor(a){this.http=a,this.WEEK_DAYS=[{isoweekday:1,name:"Segunda"},{isoweekday:2,name:"Ter\xe7a"},{isoweekday:3,name:"Quarta"},{isoweekday:4,name:"Quinta"},{isoweekday:5,name:"Sexta"},{isoweekday:6,name:"S\xe1bado"},{isoweekday:7,name:"Domingo"}],this.MONTHS=(0,s.UT)("pt-BR",s.x.Format,s.Tn.Wide).map((p,o)=>({month:o+1,name:(0,g.startCase)(p)})),this.recurrences$=new T.X(null)}fetchIndex(a,p,o,d){return this.http.get(`${h.N.apiUrl}/api/recurrences`,{params:{page:o,size:d}}).pipe((0,m.q)(1))}create(a){return this.http.post(`${h.N.apiUrl}/api/recurrences`,a).pipe((0,m.q)(1))}show(a){return this.http.get(`${h.N.apiUrl}/api/recurrences/${a}`).pipe((0,m.q)(1))}update(a,p){return this.http.patch(`${h.N.apiUrl}/api/recurrences/${a}`,p).pipe((0,m.q)(1))}getRecurrences(){return this.recurrences$.asObservable()}remove(a){return this.http.delete(`${h.N.apiUrl}/api/recurrences/${a}`).pipe((0,m.q)(1))}stringifyIsoweekday(a){const p=new Map(a.map(({isoweekday:o,name:d})=>[o,d]));return({$implicit:o})=>p.get(o)||""}stringifyMonth(a){const p=new Map(a.map(({month:o,name:d})=>[o,d]));return({$implicit:o})=>p.get(o)||""}getIsoWeekdayName(a){return new Map(this.WEEK_DAYS.map(({isoweekday:o,name:d})=>[o,d])).get(a)}getMonthName(a){return new Map(this.MONTHS.map(({month:o,name:d})=>[o,d])).get(a)}getRecurrenceOptions(){return this.http.get(`${h.N.apiUrl}/api/recurrences/options`).pipe((0,m.q)(1))}}u.\u0275fac=function(a){return new(a||u)(E.\u0275\u0275inject(O.eN))},u.\u0275prov=E.\u0275\u0275defineInjectable({token:u,factory:u.\u0275fac,providedIn:"root"}),(0,C.gn)([v.UM],u.prototype,"stringifyIsoweekday",null),(0,C.gn)([v.UM],u.prototype,"stringifyMonth",null),(0,C.gn)([v.UM],u.prototype,"getIsoWeekdayName",null),(0,C.gn)([v.UM],u.prototype,"getMonthName",null)},4362:(R,M,r)=>{r.r(M),r.d(M,{RecurrenceListComponent:()=>k});var C=r(6895),s=r(1253),v=r(6098),g=r(4335),f=r(22),T=r(1150),m=r(6693),h=r(2079),E=r(1135),O=r(9841),u=r(8372),y=r(3900),a=r(8675),p=r(3099),o=r(4004),d=r(9300),e=r(4650),D=r(5197),P=r(8709);function L(n,c){1&n&&(e.\u0275\u0275elementStart(0,"th",12),e.\u0275\u0275text(1,"ID"),e.\u0275\u0275elementEnd())}function I(n,c){1&n&&(e.\u0275\u0275elementStart(0,"th",12),e.\u0275\u0275text(1,"Descri\xe7\xe3o"),e.\u0275\u0275elementEnd())}function S(n,c){1&n&&(e.\u0275\u0275elementStart(0,"th",12),e.\u0275\u0275text(1,"Dia da Semana"),e.\u0275\u0275elementEnd())}function B(n,c){1&n&&(e.\u0275\u0275elementStart(0,"th",12),e.\u0275\u0275text(1,"Dia do m\xeas"),e.\u0275\u0275elementEnd())}function $(n,c){1&n&&(e.\u0275\u0275elementStart(0,"th",12),e.\u0275\u0275text(1,"M\xeas"),e.\u0275\u0275elementEnd())}function b(n,c){1&n&&e.\u0275\u0275element(0,"th",13),2&n&&e.\u0275\u0275property("sorter",null)}function U(n,c){if(1&n&&(e.\u0275\u0275elementStart(0,"td",16),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.id," ")}}function W(n,c){if(1&n&&(e.\u0275\u0275elementStart(0,"td",16),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.description," ")}}function A(n,c){if(1&n&&(e.\u0275\u0275elementStart(0,"td",16),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",i.recurrencesService.getIsoWeekdayName(t.isoweekday)," ")}}function K(n,c){if(1&n&&(e.\u0275\u0275elementStart(0,"td",16),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.day," ")}}function w(n,c){if(1&n&&(e.\u0275\u0275elementStart(0,"td",16),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",i.recurrencesService.getMonthName(t.month)," ")}}function j(n,c){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"td",16)(1,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const _=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.edit(_.id))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"button",18),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const _=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.remove(_.id))}),e.\u0275\u0275elementEnd()()}}function N(n,c){1&n&&(e.\u0275\u0275elementStart(0,"tr",14),e.\u0275\u0275template(1,U,2,1,"td",15),e.\u0275\u0275template(2,W,2,1,"td",15),e.\u0275\u0275template(3,A,2,1,"td",15),e.\u0275\u0275template(4,K,2,1,"td",15),e.\u0275\u0275template(5,w,2,1,"td",15),e.\u0275\u0275template(6,j,3,0,"td",15),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiCell","id"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiCell","description"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiCell","isoweekday"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiCell","day"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiCell","month"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiCell","actions"))}const z=function(){return[10,25,50,100]};function V(n,c){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"table",4),e.\u0275\u0275listener("tuiSortByChange",function(_){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.sorter$.next(_))})("directionChange",function(_){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.direction$.next(_))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"thead")(4,"tr",5),e.\u0275\u0275template(5,L,2,0,"th",6),e.\u0275\u0275template(6,I,2,0,"th",6),e.\u0275\u0275template(7,S,2,0,"th",6),e.\u0275\u0275template(8,B,2,0,"th",6),e.\u0275\u0275template(9,$,2,0,"th",6),e.\u0275\u0275template(10,b,1,1,"th",7),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"tbody",8),e.\u0275\u0275template(12,N,7,6,"tr",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"tfoot")(14,"tr")(15,"td",10)(16,"tui-table-pagination",11),e.\u0275\u0275listener("pageChange",function(_){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.changePage(_))})("sizeChange",function(_){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.changeSize(_))}),e.\u0275\u0275pipe(17,"async"),e.\u0275\u0275elementEnd()()()()()}if(2&n){const t=c.tuiLet,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("columns",i.columns)("direction",e.\u0275\u0275pipeBind1(1,14,i.direction$)||1)("tuiSortBy",e.\u0275\u0275pipeBind1(2,16,i.sorter$)),e.\u0275\u0275advance(5),e.\u0275\u0275property("tuiHead","id"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHead","description"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHead","isoweekday"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHead","day"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHead","month"),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHead","actions"),e.\u0275\u0275advance(1),e.\u0275\u0275property("data",t),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiRowOf",t),e.\u0275\u0275advance(3),e.\u0275\u0275property("colSpan",i.columns.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("items",e.\u0275\u0275pureFunction0(20,z))("total",e.\u0275\u0275pipeBind1(17,18,i.total$)||0)}}let k=(()=>{class n{constructor(t,i,_,l,H){this.alertService=t,this.cdr=i,this.router=_,this.activatedRoute=l,this.recurrencesService=H,this.columns=["id","description","isoweekday","day","month","actions"],this.recurrences=[],this.page$=new E.X(1),this.size$=new E.X(10),this.refresh$=new E.X(!1),this.direction$=new E.X(-1),this.sorter$=new E.X("id"),this.search="",this.request$=(0,O.a)([this.sorter$,this.direction$,this.page$,this.size$,this.refresh$]).pipe((0,u.b)(0),(0,y.w)(([x,F,X,Q])=>this.recurrencesService.fetchIndex(x,F,X,Q).pipe((0,a.O)(null))),(0,p.B)()),this.loading$=this.request$.pipe((0,o.U)(x=>!x)),this.total$=this.request$.pipe((0,d.h)(g.Pc),(0,o.U)(({total:x})=>x),(0,a.O)(1)),this.data$=this.request$.pipe((0,d.h)(g.Pc),(0,o.U)(x=>x.data.filter(g.Pc)),(0,a.O)([])),this.subscriptions=[]}ngOnInit(){const t=this.data$.subscribe(i=>this.recurrences=i);this.subscriptions=[t,...this.subscriptions]}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}changePage(t){this.page$.next(t+1)}changeSize(t){this.size$.next(t)}refresh(){this.refresh$.next(!0)}goTo(t){this.router.navigate([t],{relativeTo:this.activatedRoute})}remove(t){this.recurrencesService.remove(t).subscribe({next:()=>{this.recurrences=this.recurrences.filter(i=>i.id!==t),this.alertService.open("Recorr\xeancia removida com sucesso!",{status:"success"}).subscribe(),this.cdr.markForCheck()}})}edit(t){this.router.navigate([t,"editar"],{relativeTo:this.activatedRoute})}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(T.J9),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(D.F0),e.\u0275\u0275directiveInject(D.gz),e.\u0275\u0275directiveInject(P.S))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-recurrence-list"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:10,vars:5,consts:[[1,"buttons-header","tui-space_vertical-8"],["tuiButton","","icon","tuiIconPlus","size","m",3,"click"],[3,"overlay","showLoader"],["class","table","tuiTable","",3,"columns","direction","tuiSortBy","tuiSortByChange","directionChange",4,"tuiLet"],["tuiTable","",1,"table",3,"columns","direction","tuiSortBy","tuiSortByChange","directionChange"],["tuiThGroup",""],["tuiTh","","tuiSortable","",4,"tuiHead"],["tuiTh","",3,"sorter",4,"tuiHead"],["tuiTbody","",3,"data"],["tuiTr","",4,"tuiRow","tuiRowOf"],[3,"colSpan"],[1,"tui-space_top-2",3,"items","total","pageChange","sizeChange"],["tuiTh","","tuiSortable",""],["tuiTh","",3,"sorter"],["tuiTr",""],["tuiTd","",4,"tuiCell"],["tuiTd",""],["tuiIconButton","","appearance","flat","size","s","icon","tuiIconDraft","title","Editar","shape","rounded",1,"edit",3,"click"],["tuiIconButton","","appearance","flat","size","s","icon","tuiIconTrash","title","Remove","shape","rounded",1,"remove",3,"click"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div")(1,"h1"),e.\u0275\u0275text(2,"Recorr\xeancias"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",0)(4,"button",1),e.\u0275\u0275listener("click",function(){return i.goTo("criar")}),e.\u0275\u0275text(5,"Criar"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div")(7,"tui-loader",2),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,V,18,21,"table",3),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("overlay",!0)("showLoader",!!e.\u0275\u0275pipeBind1(8,3,i.loading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiLet",i.recurrences))},dependencies:[C.ez,C.Ov,m.fN,m.v0,s.jz,s.c4,s.jY,s.EE,s.Ws,s.Kt,s.fu,s.Bl,s.DZ,s.LU,s.PQ,s.gJ,f.WD,f.Ls,v.y3,v.WT,h.dS,h.kM],styles:[".buttons-header[_ngcontent-%COMP%]{padding-block:1.5rem;padding-inline:2rem;border-radius:.5rem;border:1px solid var(--tui-base-03);background-color:var(--tui-base-02)}.table[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),n})()}}]);